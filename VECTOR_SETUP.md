# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î

## üìã –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫** - –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –≤ MongoDB —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–∏—Å–∫–æ–º –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î Chroma.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
1. **MongoDB** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ü–µ–Ω–∞, –∫–æ–º–Ω–∞—Ç—ã, —Ä–∞–π–æ–Ω, –∏ —Ç.–¥.)
2. **Chroma** - –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—è–º
3. **OpenAI Embeddings** - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenAI API
–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```
OPENAI_API_KEY=your_api_key_here
```

### 3. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î –∏–∑ MongoDB
```bash
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î –∏–∑ –≤—Å–µ—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –≤ MongoDB
python real_estate_vector_db.py --populate

# –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 100 –æ–±—ä—è–≤–ª–µ–Ω–∏–π
python real_estate_vector_db.py --populate --limit 100

# –û—á–∏—Å—Ç–∏—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î
python real_estate_vector_db.py --reset

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
python real_estate_vector_db.py --stats
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞
```bash
# –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
python real_estate_vector_db.py --search "—Ç–∏—Ö–∏–π —Ä–∞–π–æ–Ω —Å –ø–∞—Ä–∫–æ–≤–∫–æ–π"

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
python hybrid_search.py
```

---

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∞–ø–∏–Ω–≥–∞ (scarpy.py)

–ó–∞–º–µ–Ω–∏—Ç–µ –≤ `scarpy.py`:
```python
# –°—Ç–∞—Ä–æ–µ
custom_settings = {
    'ITEM_PIPELINES': {'__main__.MongoDBPipeline': 1}
}

# –ù–æ–≤–æ–µ
custom_settings = {
    'ITEM_PIPELINES': {'hybrid_pipeline.HybridMongoDBPipeline': 1}
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ API (main.py –∏–ª–∏ app.py)

```python
from hybrid_search import HybridRealEstateSearch

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
search_engine = HybridRealEstateSearch()

# –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫
results = search_engine.search(
    filters={
        "city": "Gdansk",
        "rooms": 2,
        "max_price": 4000
    },
    semantic_query="—Ç–∏—Ö–∏–π —Ä–∞–π–æ–Ω —Å –±–∞–ª–∫–æ–Ω–æ–º",
    listing_type="rent",
    limit=10
)

for result in results:
    print(f"ID: {result['_id']}")
    print(f"–ó–∞–≥–æ–ª–æ–≤–æ–∫: {result.get('title')}")
    print(f"–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —Å–∫–æ—Ä: {result.get('semantic_score', 0)}")
    print(f"–¶–µ–Ω–∞: {result.get('price')}")
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –¢–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
```python
results = search_engine.search(
    filters={
        "city": "Warszawa",
        "rooms": [2, 3],
        "min_price": 2000,
        "max_price": 5000,
        "building_type": "block"
    },
    listing_type="rent"
)
```

### 2. –¢–æ–ª—å–∫–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
```python
results = search_engine.search(
    semantic_query="–Ω–æ–≤–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ä–µ–º–æ–Ω—Ç–æ–º —Ä—è–¥–æ–º —Å –º–µ—Ç—Ä–æ",
    listing_type="sale"
)
```

### 3. –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
```python
results = search_engine.search(
    filters={
        "city": "Gdansk", 
        "max_price": 4000
    },
    semantic_query="—Å–µ–º–µ–π–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ç–∏—Ö–æ–º —Ä–∞–π–æ–Ω–µ —Å –ø–∞—Ä–∫–æ–≤–∫–æ–π",
    listing_type="rent"
)
```

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

- `real_estate_embedding_function.py` - —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è embeddings
- `real_estate_vector_db.py` - —Ä–∞–±–æ—Ç–∞ —Å –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î Chroma
- `hybrid_pipeline.py` - pipeline –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ MongoDB + Chroma
- `hybrid_search.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

---

## üîç –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∏—Å–∫

### –≠—Ç–∞–ø 1: MongoDB —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
```
–ó–∞–ø—Ä–æ—Å: "2 –∫–æ–º–Ω–∞—Ç—ã –≤ –ì–¥–∞–Ω—å—Å–∫–µ –¥–æ 4000 –∑–ª —Å –ø–∞—Ä–∫–æ–≤–∫–æ–π"
‚îú‚îÄ‚îÄ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã ‚Üí MongoDB
‚îÇ   ‚îú‚îÄ‚îÄ room_count: 2
‚îÇ   ‚îú‚îÄ‚îÄ city: "Gdansk"
‚îÇ   ‚îî‚îÄ‚îÄ price: ‚â§ 4000
‚îÇ
‚îî‚îÄ‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: 150 –æ–±—ä—è–≤–ª–µ–Ω–∏–π ‚Üí [ID1, ID2, ..., ID150]
```

### –≠—Ç–∞–ø 2: –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
```
–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å: "—Å –ø–∞—Ä–∫–æ–≤–∫–æ–π"
‚îú‚îÄ‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ embedding ‚Üí [0.1, -0.2, 0.5, ...]
‚îú‚îÄ‚îÄ –ü–æ–∏—Å–∫ –≤ Chroma —Å—Ä–µ–¥–∏ ID1-ID150
‚îî‚îÄ‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: 10 —Å–∞–º—ã—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
```

### –≠—Ç–∞–ø 3: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```
–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
‚îú‚îÄ‚îÄ –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ MongoDB
‚îú‚îÄ‚îÄ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —Å–∫–æ—Ä –∏–∑ Chroma
‚îî‚îÄ‚îÄ –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **MongoDB —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: ~10-50ms (—Å –∏–Ω–¥–µ–∫—Å–∞–º–∏)
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: ~100-300ms (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ë–î)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: ~200-400ms –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
1. –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –≤ MongoDB:
   ```javascript
   db.rent_listings.createIndex({"city": 1, "room_count": 1, "price": 1})
   db.sale_listings.createIndex({"city": 1, "room_count": 1, "price": 1})
   ```

2. –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ —Ä–∞–∑–º–µ—Ä –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥)

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ OpenAI API
```
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
1. OPENAI_API_KEY —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env
2. –£ –≤–∞—Å –µ—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ OpenAI
3. API –∫–ª—é—á –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π
```

### Chroma –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
python real_estate_vector_db.py --stats

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –ë–î
python real_estate_vector_db.py --reset --populate
```

### MongoDB –ø—É—Å—Ç–æ–π
```bash
# –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∞–ø–∏–Ω–≥
python scarpy.py

# –ü–æ—Ç–æ–º –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î
python real_estate_vector_db.py --populate
```
